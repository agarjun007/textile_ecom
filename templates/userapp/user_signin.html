<!DOCTYPE html>

{% load static %}
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" type="text/css" href=" {% static 'userapp/css/user_signin.css' %} " />

   

    <title>Signin</title>
    <link  rel="icon"   href="https://static.thenounproject.com/png/16507-200.png"  type="image/icon type"/>
  </head>

  <body>
    {% if otp == 1 %}
    <div class="login-dark">
      <form id="form" style="margin-left: 20%;">
      
        <h2 style="text-align: center; color:#0a59ad; margin-top: -35px;">Login</h2>
        <div class="illustration" style="margin-top: -38px;"><img src="{% static 'userapp/images/logo.png' %}"></div>
        <div class="form-group">
          <input style="color: black;"
            id="mobile"
            class="form-control"
            type="text"
            name="mobile"
            placeholder="Mobile Number"
          />
        </div>
        
        <div class="form-group">
         <a href="/verifyotp/"><button id="button"  class="btn btn-primary btn-block" type="button">
            Send OTP
          </button></a>
        </div>
 


        <span style="color: red;" id="invalid"></span>
        <div class="form-group">
          <p style="color: black;">Login with password<a href="/signin/">click here</a></p>
  
        </div>
        
        <p style="color: black;">Don't have an account?<a href="/signup/">Sign Up</a></p>
        <a
          href="https://agarjun007.github.io/personal_website/index.html"
          target="_blank"
          class="forgot"
          >© 2020 Design by ARJUN.A.G
        </a>
      
    </div>
  </form>
 
    {% else %}

    <div class="login-dark">
      <form id="form" style="margin-left: 20%;">
        {% csrf_token %}
        <h2 style="text-align: center; color:#0a59ad; margin-top: -35px;">Login</h2>
        <div class="illustration" style="margin-top: -38px;"><img src="{% static 'userapp/images/logo.png' %}"></div>
        <div class="form-group">
          <input style="color: black;"
            id="username"
            class="form-control"
            type="text"
            name="username"
            placeholder="username"
          />
        </div>
        <div class="form-group">
          <input style="color: black;"" id="pass" class="form-control" type="password" name="password"  placeholder="Password"/>
        </div>
        <div class="form-group">
          <button id="button"  class="btn btn-primary btn-block" type="button">
            Log In
          </button>
        </div>
        <span style="color: red;" id="invalid"></span>
        <div class="form-group">
          <p style="color: black;">Login with Mobile?<a href="/otplogin/">click here</a></p>
  
        </div>
        
        <p style="color: black;">Don't have an account?<a href="/signup/">Sign Up</a></p>
        <a
          href="https://agarjun007.github.io/personal_website/index.html"
          target="_blank"
          class="forgot"
          >© 2020 Design by ARJUN.A.G
        </a>
      </form>
    </div>
    {% endif %}

    {% if modal == 1 %}
    <!-- Modal -->
    <div class="modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Modal body text goes here.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary">Save changes</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    {% endif%}
    

  <script
    src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
    integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://code.jquery.com/jquery-3.5.0.min.js"
    integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ="
    crossorigin="anonymous"
  ></script>
  
  <script type="text/javascript">
    $( document ).ready(function() {
      $( "#button" ).click(function() {
        var userData = {
          csrfmiddlewaretoken: '{{ csrf_token }}',
          username: $('#username').val(),
          password: $('#pass').val()
        }
      if (userData.username === '')
     {
      $('#invalid').html('please enter username')
     }
          
     else if (userData.password === '')
     {
      $('#invalid').html('please enter password')
     }
     else{
        $.ajax({
            url : '/signin/',
            type: "POST",
            data : userData,
            dataType : "json",
            success: function( data ){
              if(data == 'valid')
                window.location.replace("/home")
              if (data == 'blocked') { 
                $('#invalid').html('Account Blocked')
                $('#pass').val('')
                }
              if(data == 'invalid'){
                $('#invalid').html('invalid Username/Password')
                $('#pass').val('')
              }
            }
        });
     }
      });
     
    });
  </script>
  
    
  </body>
</html>
